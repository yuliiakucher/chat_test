(this.webpackJsonpchat_test=this.webpackJsonpchat_test||[]).push([[0],{12:function(e,s,t){e.exports={left:"MenuPage_left__1kwKL",header:"MenuPage_header__3hZ4k",img:"MenuPage_img__2cbjG",search:"MenuPage_search__3H-3a",btn:"MenuPage_btn__1DVCO",chats:"MenuPage_chats__38DMA",chat_header:"MenuPage_chat_header__1qPJR",result:"MenuPage_result__36s8Z",subresult:"MenuPage_subresult__3OdmR",timestamp:"MenuPage_timestamp__1vvDQ"}},13:function(e,s,t){e.exports={container:"OneUser_container__3XOl0",img:"OneUser_img__31ipx",center:"OneUser_center__2gm98",nav:"OneUser_nav__2lThL",user_name:"OneUser_user_name__1V82Z",last_msg:"OneUser_last_msg__14sjU"}},50:function(e,s,t){},51:function(e,s,t){},6:function(e,s,t){e.exports={center:"ContentPage_center__1n8xQ",messages:"ContentPage_messages__174E-",message_header:"ContentPage_message_header__etKqg",user_name:"ContentPage_user_name__2oJVk",send_message:"ContentPage_send_message__1_RB-",left_m:"ContentPage_left_m__2PAtM",right_m:"ContentPage_right_m__2kc0w",img:"ContentPage_img__28lZj",container:"ContentPage_container__3ifT_",container_r:"ContentPage_container_r__Fx3gT",date:"ContentPage_date__3Otcs",input:"ContentPage_input__5UxTb",btn:"ContentPage_btn__SDm4Z"}},75:function(e,s,t){"use strict";t.r(s);var a=t(1),n=t(0),c=t.n(n),r=t(19),i=t.n(r),u=(t(50),t(5)),l=(t(51),t(26)),o=t(14),m=t(42),_=t(43),d="GET_MESSAGE",g="SET_USERS",h="SET_MSG",j="CLEAR_MESSAGES",p="CHANGE_FIRST_TIME",b="SEARCH_MESSAGES",O={firstTime:!0,allMessages:[],currentUser:"",users:[],msg:"",searchResults:[]},f=function(e){return{type:h,payload:e}},x=Object(o.d)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,s=arguments.length>1?arguments[1]:void 0;switch(s.type){case d:return Object(u.a)(Object(u.a)({},e),{},{allMessages:[].concat(Object(l.a)(e.allMessages),[{id:s.id,user_id:s.user_id,message:s.message,timestamp:s.timestamp}])});case h:return Object(u.a)(Object(u.a)({},e),{},{msg:s.payload});case g:return Object(u.a)(Object(u.a)({},e),{},{users:[].concat(Object(l.a)(e.users),[{id:s.id,user_name:s.user_name,photo:s.photo}])});case j:return Object(u.a)(Object(u.a)({},e),{},{allMessages:[]});case p:return Object(u.a)(Object(u.a)({},e),{},{firstTime:s.payload});case b:return Object(u.a)(Object(u.a)({},e),{},{searchResults:[].concat(Object(l.a)(e.searchResults),[{id:s.id,user_id:s.user_id,message:s.message,timestamp:s.timestamp}])});default:return e}}),Object(o.a)(m.a)),v=t(24),T=t(25),S=t(12),N=t.n(S),E=t(13),R=t.n(E),w=t(15),C=function(e){var s=e.user;return Object(a.jsxs)("div",{className:R.a.container,children:[Object(a.jsx)("img",{className:R.a.img,src:s.photo,alt:"user-photo"}),Object(a.jsx)(w.b,{to:"/".concat(s.id),className:R.a.nav,children:Object(a.jsxs)("div",{className:R.a.center,children:[Object(a.jsx)("p",{className:R.a.user_name,children:s.user_name}),Object(a.jsx)("p",{className:R.a.last_msg,children:"last message"})]})}),Object(a.jsx)("p",{children:"date"})]})},M=t(22),D=t(23),I=function(e){var s=Object(n.useState)(""),t=Object(T.a)(s,2),c=t[0],r=t[1],i=null;e.users.map((function(s){e.searchResults[0]&&e.searchResults[0].user_id===s.id&&(i=s.user_name)}));var u=null;return e.users.map((function(s){e.searchResults[0]&&e.searchResults[0].user_id===s.id&&(u=s.photo)})),Object(a.jsxs)("div",{className:N.a.left,children:[Object(a.jsxs)("div",{className:N.a.header,children:[Object(a.jsx)("img",{className:N.a.img,src:"https://upload.wikimedia.org/wikipedia/commons/7/70/User_icon_BLACK-01.png",alt:"user"}),Object(a.jsxs)("div",{children:[Object(a.jsx)("input",{className:N.a.search,value:c,onChange:function(e){return r(e.target.value)},placeholder:"Search or start new chat"}),Object(a.jsx)("button",{className:N.a.btn,onClick:function(){e.searchMessages(c),r("")},children:Object(a.jsx)(M.a,{icon:D.b})})]})]}),Object(a.jsxs)("div",{className:N.a.chats,children:[Object(a.jsx)("p",{className:N.a.chat_header,children:"Chats"}),0!==e.searchResults.length&&e.searchResults.map((function(e){return Object(a.jsxs)("div",{className:N.a.result,children:[Object(a.jsxs)("div",{className:N.a.subresult,children:[Object(a.jsx)("img",{className:R.a.img,src:u,alt:"search-photo"}),Object(a.jsxs)("p",{children:[i,":"]})]}),Object(a.jsxs)("p",{children:[" ",e.message]}),Object(a.jsx)("p",{className:N.a.timestamp,children:e.timestamp})]})})),e.users.map((function(e){return Object(a.jsx)(C,{user:e},e.id)}))]})]})},P=t(4),L=t(6),y=t.n(L),q=Object(P.e)((function(e){var s=Object(n.useState)(""),t=Object(T.a)(s,2),c=t[0],r=t[1];Object(n.useEffect)((function(){openDatabase("DB","1.0","Test DB",2097152).transaction((function(s){s.executeSql("SELECT * FROM chat WHERE user_id=".concat(e.match.params.user_id),[],(function(s,t){e.clearMessage();for(var a=0;a<t.rows.length;a++)e.setMessage(a,t.rows.item(a).user_id,t.rows.item(a).message,t.rows.item(a).timestamp)}),null)}))}),[e.match.params.user_id,e.msg]);var i=null;e.users.map((function(s){e.messages[1]&&e.messages[1].user_id===s.id&&(i=s.user_name)}));var u=null;return e.users.map((function(s){e.messages[0]&&e.messages[0].user_id===s.id&&(u=s.photo)})),Object(a.jsxs)("div",{className:y.a.center,children:[Object(a.jsxs)("div",{className:y.a.message_header,children:[Object(a.jsx)("img",{className:y.a.img,src:u,alt:"user_header_photo"}),Object(a.jsx)("p",{className:y.a.user_name,children:i})]}),Object(a.jsx)("div",{className:y.a.messages,children:e.messages.map((function(e){return e.id%2!==0?Object(a.jsxs)("div",{className:y.a.container,children:[Object(a.jsx)("img",{className:y.a.img,src:u,alt:"msg-photo"}),Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{className:y.a.left_m,children:e.message}),Object(a.jsx)("p",{className:y.a.date,children:e.timestamp})]})]},e.id):Object(a.jsxs)("div",{className:y.a.container_r,children:[Object(a.jsx)("div",{className:y.a.right_m,children:e.message},e.id),Object(a.jsx)("p",{className:y.a.date,children:e.timestamp})]})}))}),Object(a.jsxs)("div",{className:y.a.send_message,children:[Object(a.jsx)("input",{value:c,onChange:function(e){return r(e.target.value)},className:y.a.input,placeholder:"Type your message"}),Object(a.jsx)("button",{className:y.a.btn,onClick:function(){e.sendMessage(e.match.params.user_id,c),e.setMsg(c),setTimeout((function(){e.getResponse(e.match.params.user_id)}),1e4),r("")},children:Object(a.jsx)(M.a,{icon:D.a})})]})]})}));var U=Object(o.c)(P.e,Object(v.b)((function(e){return{messages:e.allMessages,user:e.currentUser,users:e.users,msg:e.msg,firstTime:e.firstTime,searchResults:e.searchResults}}),{setMessage:function(e,s,t,a){return{type:d,id:e,user_id:s,message:t,timestamp:a}},setUsers:function(e,s,t){return{type:g,id:e,user_name:s,photo:t}},clearMessage:function(){return{type:j}},getResponse:function(e){return function(s){var t=openDatabase("DB","1.0","Test DB",2097152);_.get("https://api.chucknorris.io/jokes/random").then((function(a){t.transaction((function(t){t.executeSql("INSERT INTO chat (user_id, timestamp, message) values(?, ?, ?)",[e,(new Date).toLocaleString(),a.data.value],null,null),s(f(a.data.value))}))}))}},sendMessage:function(e,s){return function(){openDatabase("DB","1.0","Test DB",2097152).transaction((function(t){t.executeSql("INSERT INTO chat (user_id, timestamp, message) values(?, ?, ?)",[e,(new Date).toLocaleString(),s],null,null)}))}},setMsg:f,changeFirstTime:function(e){return{type:p,payload:e}},searchMessages:function(e){return function(s){openDatabase("DB","1.0","Test DB",2097152).transaction((function(t){t.executeSql("SELECT * FROM chat WHERE message LIKE '%".concat(e,"%'"),[],(function(e,t){for(var a=0;a<t.rows.length;a++)s((n=a,c=t.rows.item(a).user_id,r=t.rows.item(a).message,i=t.rows.item(a).timestamp,{type:b,id:n,user_id:c,message:r,timestamp:i}));var n,c,r,i}),null)}))}}}))((function(e){return Object(n.useEffect)((function(){var s=openDatabase("DB","1.0","Test DB",2097152);s.transaction((function(s){s.executeSql("SELECT COUNT(*) FROM users",[],(function(e){}),(function(s,t){e.changeFirstTime(!1),s.executeSql("CREATE TABLE users (id REAL UNIQUE, user_name TEXT, photo TEXT)",[],null,null)}))})),s.transaction((function(s){s.executeSql("SELECT COUNT(*) FROM chat",[],(function(e){}),(function(s,t){e.changeFirstTime(!1),s.executeSql("CREATE TABLE chat (user_id REAL, timestamp REAL, message TEXT)",[],null,null)}))})),s.transaction((function(e){e.executeSql("SELECT * FROM users",[],(function(e,s){0===s.rows.length&&(e.executeSql("INSERT INTO chat (user_id, timestamp, message) values(?, ?, ?)",[1,(new Date).toLocaleString(),"hello hello hello"],null,null),e.executeSql("INSERT INTO chat (user_id, timestamp, message) values(?, ?, ?)",[1,(new Date).toLocaleString(),"byebyebyebye"],null,null),e.executeSql("INSERT INTO chat (user_id, timestamp, message) values(?, ?, ?)",[2,(new Date).toLocaleString(),"how are you?"],null,null),e.executeSql("INSERT INTO chat (user_id, timestamp, message) values(?, ?, ?)",[2,(new Date).toLocaleString(),"gracia"],null,null),e.executeSql("INSERT INTO chat (user_id, timestamp, message) values(?, ?, ?)",[3,(new Date).toLocaleString(),"good"],null,null),e.executeSql("INSERT INTO chat (user_id, timestamp, message) values(?, ?, ?)",[3,(new Date).toLocaleString(),"see you tomorrow"],null,null))}),null)})),e.firstTime&&s.transaction((function(e){e.executeSql("INSERT INTO users (id, user_name, photo) values(?, ?, ?)",[1,"vova","https://www.pavilionweb.com/wp-content/uploads/2017/03/man-300x300.png"],null,null),e.executeSql("INSERT INTO users (id, user_name, photo) values(?, ?, ?)",[2,"masha","https://upload.wikimedia.org/wikipedia/commons/thumb/5/50/User_icon-cp.svg/1200px-User_icon-cp.svg.png"],null,null),e.executeSql("INSERT INTO users (id, user_name, photo) values(?, ?, ?)",[3,"sonia","https://upload.wikimedia.org/wikipedia/commons/thumb/d/d2/Crystal_Clear_kdm_user_female.svg/1200px-Crystal_Clear_kdm_user_female.svg.png"],null,null)})),s.transaction((function(s){s.executeSql("SELECT * FROM users",[],(function(s,t){for(var a=0;a<t.rows.length;a++)e.setUsers(t.rows.item(a).id,t.rows.item(a).user_name,t.rows.item(a).photo)}),null)}))}),[]),Object(a.jsx)("div",{className:"wrapper",children:Object(a.jsxs)("div",{className:"container",children:[Object(a.jsx)(I,Object(u.a)({},e)),Object(a.jsx)(P.a,{path:"/:user_id",render:function(){return Object(a.jsx)(q,Object(u.a)({},e))}})]})})})),k=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,76)).then((function(s){var t=s.getCLS,a=s.getFID,n=s.getFCP,c=s.getLCP,r=s.getTTFB;t(e),a(e),n(e),c(e),r(e)}))};i.a.render(Object(a.jsx)(c.a.StrictMode,{children:Object(a.jsx)(v.a,{store:x,children:Object(a.jsx)(w.a,{children:Object(a.jsx)(U,{})})})}),document.getElementById("root")),k()}},[[75,1,2]]]);
//# sourceMappingURL=main.f83cfe41.chunk.js.map